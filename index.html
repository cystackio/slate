
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Tài liệu kỹ thuật CyStack API</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;python&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="python">python</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#gi-i-thi-u" class="toc-h1 toc-link" data-title="Giới thiệu">Giới thiệu</a>
          </li>
          <li>
            <a href="#xac-th-c" class="toc-h1 toc-link" data-title="Xác thực">Xác thực</a>
          </li>
          <li>
            <a href="#target" class="toc-h1 toc-link" data-title="Target">Target</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#li-t-ke-danh-sach-target" class="toc-h2 toc-link" data-title="Liệt kê danh sách target">Liệt kê danh sách target</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#scan" class="toc-h1 toc-link" data-title="Scan">Scan</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#khai-ni-m" class="toc-h2 toc-link" data-title="Khái niệm">Khái niệm</a>
                  </li>
                  <li>
                    <a href="#t-o-scan" class="toc-h2 toc-link" data-title="Tạo scan">Tạo scan</a>
                  </li>
                  <li>
                    <a href="#li-t-ke-scan" class="toc-h2 toc-link" data-title="Liệt kê scan">Liệt kê scan</a>
                  </li>
                  <li>
                    <a href="#d-ng-m-t-scan" class="toc-h2 toc-link" data-title="Dừng một scan">Dừng một scan</a>
                  </li>
                  <li>
                    <a href="#xem-chi-ti-t-m-t-scan" class="toc-h2 toc-link" data-title="Xem chi tiết một scan">Xem chi tiết một scan</a>
                  </li>
                  <li>
                    <a href="#xoa-m-t-scan" class="toc-h2 toc-link" data-title="Xóa một scan">Xóa một scan</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#vulnerability" class="toc-h1 toc-link" data-title="Vulnerability">Vulnerability</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#khai-ni-m-2" class="toc-h2 toc-link" data-title="Khái niệm">Khái niệm</a>
                  </li>
                  <li>
                    <a href="#li-t-ke-l-h-ng" class="toc-h2 toc-link" data-title="Liệt kê lỗ hổng">Liệt kê lỗ hổng</a>
                  </li>
                  <li>
                    <a href="#xem-chi-ti-t-l-h-ng" class="toc-h2 toc-link" data-title="Xem chi tiết lỗ hổng">Xem chi tiết lỗ hổng</a>
                  </li>
                  <li>
                    <a href="#c-p-nh-t-l-h-ng" class="toc-h2 toc-link" data-title="Cập nhật lỗ hổng">Cập nhật lỗ hổng</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#monitoring" class="toc-h1 toc-link" data-title="Monitoring">Monitoring</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#khai-ni-m-3" class="toc-h2 toc-link" data-title="Khái niệm">Khái niệm</a>
                  </li>
                  <li>
                    <a href="#l-y-thong-tin-v-tr-ng-thai-up-down" class="toc-h2 toc-link" data-title="Lấy thông tin về trạng thái up/down">Lấy thông tin về trạng thái up/down</a>
                  </li>
                  <li>
                    <a href="#l-y-thong-tin-c-u-hinh-ki-m-tra-up-down" class="toc-h2 toc-link" data-title="Lấy thông tin cấu hình kiểm tra up/down">Lấy thông tin cấu hình kiểm tra up/down</a>
                  </li>
                  <li>
                    <a href="#c-p-nh-t-c-u-hinh-ki-m-tra-up-down" class="toc-h2 toc-link" data-title="Cập nhật cấu hình kiểm tra up/down">Cập nhật cấu hình kiểm tra up/down</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='https://cystack.io/apikeys'>Tạo API Key</a></li>
            <li><a href='/'>English</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='gi-i-thi-u'>Giới thiệu</h1>
<p>Dưới đây là tài liệu hướng dẫn sử dụng CyStack API. Bạn có thể sử dụng các API của chúng tôi để thực hiện các chức năng quản lý trên CyStack Platform. Bằng cách này, bạn có thể tích hợp CyStack Platform vào hệ thống của bạn hoặc tự phát triển một Scanner trên hạ tầng sẵn có của chúng tôi. </p>

<p>Các chức năng mà bạn được phép/không được phép sử dụng thông qua CyStack APIClient</p>

<table><thead>
<tr>
<th>Chức năng</th>
<th>Truy cập qua API</th>
</tr>
</thead><tbody>
<tr>
<td>Tạo target</td>
<td>Không</td>
</tr>
<tr>
<td>Liệt kê và xem thông tin target</td>
<td>Có</td>
</tr>
<tr>
<td>Tạo và xem thông tin scan</td>
<td>Có</td>
</tr>
<tr>
<td>Xem thông tin lỗ hổng</td>
<td>Có</td>
</tr>
<tr>
<td>Xem thông tin và cấu hình Monitoring</td>
<td>Có</td>
</tr>
<tr>
<td>Quản lý thông tin người dùng</td>
<td>Không</td>
</tr>
<tr>
<td>Quản lý danh sách nhận tin (notifications)</td>
<td>Không</td>
</tr>
<tr>
<td>Quản lý API Keys</td>
<td>Không</td>
</tr>
</tbody></table>

<p>Chúng tôi có các đoạn code mẫu được viết bằng Shell và Python. Bạn có thể tham khảo ở cột bên phải, ứng với các chức năng được cung cấp. Việc truy cập API bằng các ngôn ngữ lập trình khác hoàn toàn tương tự.</p>

<aside class="notice">
Lưu ý: Các API không thuộc phạm vi tài liệu này được dành cho những mục đích khác của CyStack Team. Các developer <b>không nên sử dụng</b> chúng nếu không được phép.
</aside>
<h1 id='xac-th-c'>Xác thực</h1>
<p>CyStack Platform sử dụng hình thức xác thực thông qua API key (Bearer Token) cho tất cả các request từ Client gửi đến API Server. Bạn có thể tạo mới một API key từ trang <a href="https://cystack.io/apikeys">Quản lý API key</a>.</p>

<p>Sau khi đã có được API key, bạn phải thêm vào header của tất cả các request key/value sau:</p>

<p><code>Authorization: Bearer cystackapiexample</code></p>

<aside class="notice">
Bạn phải thay <code>cystackapiexample</code> bằng API key thật của bạn.
</aside>
<h1 id='target'>Target</h1><h2 id='li-t-ke-danh-sach-target'>Liệt kê danh sách target</h2><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">ROOT_URL</span> <span class="o">=</span> <span class="s">'https://api.cystack.io/v1'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'cystackapiexample'</span>
<span class="n">AUTHENTICATION_HEADER</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Bearer </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">API_KEY</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">list_target</span><span class="p">():</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="s">"</span><span class="si">%</span><span class="s">s/targets"</span> <span class="o">%</span> <span class="n">ROOT_URL</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">AUTHENTICATION_HEADER</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">print</span> <span class="n">list_target</span><span class="p">()</span> 
</code></pre><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.cystack.io/v1/targets"</span>
  -H <span class="s2">"Authorization: Bearer cystackapiexample"</span>
</code></pre>
<blockquote>
<p>Nếu thành công, kết quả nhận được sẽ là JSON như sau:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">  
   </span><span class="s2">"count"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
   </span><span class="s2">"next"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"previous"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"results"</span><span class="p">:[</span><span class="w">  
      </span><span class="p">{</span><span class="w">  
         </span><span class="s2">"verification"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="s2">"href"</span><span class="p">:</span><span class="s2">"/v1/targets/599fc347-3e46-4163-8a1d-444bd1928a85"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"599fc347-3e46-4163-8a1d-444bd1928a85"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"address"</span><span class="p">:</span><span class="s2">"https://cystack.net"</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Endpoint này liệt kê tất cả các target hiện có của user (ứng với API key)</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>GET https://api.cystack.io/v1/targets</code></p>
<h3 id='cac-tham-s-theo-url'>Các tham số theo URL</h3>
<table><thead>
<tr>
<th>Tham số</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>page</td>
<td>Mặc định, kết quả trả về sẽ được phân trang với 10 kết quả/trang. Tham số page nhận vào một số tự nhiên đại diện cho trang cần lấy</td>
</tr>
<tr>
<td>q</td>
<td>Từ khóa dùng để lọc target</td>
</tr>
<tr>
<td>ordering</td>
<td>Giá trị được ưu tiên sắp xếp. Giá trị tham số hợp lệ <code>?ordering=target</code>, <code>?ordering=verification</code>, <code>?ordering=target,verification</code>. Nếu muốn sắp xếp theo chiều ngược lại, thêm dấu <code>-</code> vào trước giá trị cần sắp xếp chẳng hạn <code>?ordering=-target</code></td>
</tr>
</tbody></table>
<h3 id='y-nghia-k-t-qu-tr-v'>Ý nghĩa kết quả trả về</h3>
<table><thead>
<tr>
<th>Key</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>count</td>
<td>Số lượng kết quả lấy được</td>
</tr>
<tr>
<td>next</td>
<td>URL trang kết quả tiếp theo, nếu trang tiếp theo không có dữ liệu thì trả về <code>null</code></td>
</tr>
<tr>
<td>previous</td>
<td>URL trang kết quả phía trước, nếu trang trước không có dữ liệu thì trả về <code>null</code></td>
</tr>
<tr>
<td>results</td>
<td>Một mảng các đối tượng target, trong đó các thành phần được mô tả dưới đây</td>
</tr>
<tr>
<td>verification</td>
<td>Tình trạng xác thực chủ sở hữu, là 0/1 đại diện cho <code>đã xác thực chủ sở hữu</code> / <code>chưa xác thực chủ sở hữu</code></td>
</tr>
<tr>
<td>href</td>
<td>Đường dẫn đến endpoint xem thông tin chi tiết target. Địa chỉ tuyệt đối = <code>https://api.cystack.io</code> + <code>đường dẫn</code></td>
</tr>
<tr>
<td>id</td>
<td>ID của target</td>
</tr>
<tr>
<td>address</td>
<td>Địa chỉ truy cập target</td>
</tr>
</tbody></table>

<aside class="notice">
Lưu ý — Request phải gửi kèm API Key
</aside>
<h1 id='scan'>Scan</h1><h2 id='khai-ni-m'>Khái niệm</h2>
<p>Một scan tương ứng với một lần quét lỗ hổng, trên một target xác định</p>
<h2 id='t-o-scan'>Tạo scan</h2><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">ROOT_URL</span> <span class="o">=</span> <span class="s">'https://api.cystack.io/v1'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'cystackapiexample'</span>
<span class="n">AUTHENTICATION_HEADER</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Bearer </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">API_KEY</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">create_scan</span><span class="p">():</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="s">"</span><span class="si">%</span><span class="s">s/scans"</span> <span class="o">%</span> <span class="n">ROOT_URL</span>
    <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"target"</span><span class="p">:</span> <span class="s">"395a2f59-ad32-4e1c-b9b0-4063a55cf4e2"</span><span class="p">,</span>
        <span class="s">"profile"</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s">"notification"</span><span class="p">:</span> <span class="p">[</span>
            <span class="mi">34</span>
        <span class="p">],</span>
        <span class="s">"description"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span>
        <span class="s">"advances"</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">"headers"</span><span class="p">:</span> <span class="p">{</span><span class="s">"ping"</span><span class="p">:</span> <span class="s">"123"</span><span class="p">},</span>
            <span class="s">"authentication"</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">"authentication_method"</span><span class="p">:</span> <span class="s">"cookie"</span><span class="p">,</span>
                <span class="s">"username"</span><span class="p">:</span> <span class="s">""</span><span class="p">,</span>
                <span class="s">"password"</span><span class="p">:</span> <span class="s">""</span><span class="p">,</span>
                <span class="s">"log_out_url"</span><span class="p">:</span> <span class="s">""</span><span class="p">,</span>
                <span class="s">"cookie"</span><span class="p">:</span> <span class="s">"cookieeeeeeeeeeeeeeeeee"</span><span class="p">,</span>
                <span class="s">"username_field"</span><span class="p">:</span> <span class="s">""</span><span class="p">,</span>
                <span class="s">"password_field"</span><span class="p">:</span> <span class="s">""</span><span class="p">,</span>
                <span class="s">"auth_url"</span><span class="p">:</span> <span class="s">""</span><span class="p">,</span>
                <span class="s">"check_url"</span><span class="p">:</span> <span class="s">""</span><span class="p">,</span>
                <span class="s">"check_string"</span><span class="p">:</span> <span class="s">""</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">AUTHENTICATION_HEADER</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">post_data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">201</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s">'Location'</span><span class="p">]</span>
    <span class="k">return</span> <span class="bp">None</span>

<span class="k">print</span> <span class="n">create_scan</span><span class="p">()</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl -i -s -k  -X <span class="s1">$'POST'</span> <span class="se">\</span>
    -H <span class="s1">$'Authorization: Bearer cystackapiexample'</span> -H <span class="s1">$'content-type: application/json'</span> <span class="se">\</span>
    --data-binary <span class="s1">$'{</span><span class="se">\"</span><span class="s1">target</span><span class="se">\"</span><span class="s1">: </span><span class="se">\"</span><span class="s1">395a2f59-ad32-4e1c-b9b0-4063a55cf4e2</span><span class="se">\"</span><span class="s1">,</span><span class="se">\"</span><span class="s1">profile</span><span class="se">\"</span><span class="s1">: 5,</span><span class="se">\"</span><span class="s1">notification</span><span class="se">\"</span><span class="s1">: [34],</span><span class="se">\"</span><span class="s1">description</span><span class="se">\"</span><span class="s1">: </span><span class="se">\"</span><span class="s1">string</span><span class="se">\"</span><span class="s1">,</span><span class="se">\"</span><span class="s1">advances</span><span class="se">\"</span><span class="s1">: {</span><span class="se">\"</span><span class="s1">headers</span><span class="se">\"</span><span class="s1">: {</span><span class="se">\"</span><span class="s1">ping</span><span class="se">\"</span><span class="s1">: </span><span class="se">\"</span><span class="s1">123</span><span class="se">\"</span><span class="s1">},</span><span class="se">\"</span><span class="s1">authentication</span><span class="se">\"</span><span class="s1">: {</span><span class="se">\"</span><span class="s1">authentication_method</span><span class="se">\"</span><span class="s1">: </span><span class="se">\"</span><span class="s1">cookie</span><span class="se">\"</span><span class="s1">,</span><span class="se">\"</span><span class="s1">username</span><span class="se">\"</span><span class="s1">: </span><span class="se">\"\"</span><span class="s1">,</span><span class="se">\"</span><span class="s1">password</span><span class="se">\"</span><span class="s1">: </span><span class="se">\"\"</span><span class="s1">,</span><span class="se">\"</span><span class="s1">log_out_url</span><span class="se">\"</span><span class="s1">: </span><span class="se">\"\"</span><span class="s1">,</span><span class="se">\"</span><span class="s1">cookie</span><span class="se">\"</span><span class="s1">: </span><span class="se">\"</span><span class="s1">cookieeeeeeeeeeeeeeeeee</span><span class="se">\"</span><span class="s1">,</span><span class="se">\"</span><span class="s1">username_field</span><span class="se">\"</span><span class="s1">: </span><span class="se">\"\"</span><span class="s1">,</span><span class="se">\"</span><span class="s1">password_field</span><span class="se">\"</span><span class="s1">: </span><span class="se">\"\"</span><span class="s1">,</span><span class="se">\"</span><span class="s1">auth_url</span><span class="se">\"</span><span class="s1">: </span><span class="se">\"\"</span><span class="s1">,</span><span class="se">\"</span><span class="s1">check_url</span><span class="se">\"</span><span class="s1">: </span><span class="se">\"\"</span><span class="s1">,</span><span class="se">\"</span><span class="s1">check_string</span><span class="se">\"</span><span class="s1">: </span><span class="se">\"\"</span><span class="s1">}}}'</span> <span class="se">\</span>
    <span class="s1">$'https://api.cystack.io/v1/scans'</span>
</code></pre>
<blockquote>
<p>Nếu thành công, HTTP Response sẽ có Status code 201 và trong header chứa location tham chiếu đến đối tượng mới được tạo</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="s2">"Location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/scans/65fa9150-fbca-49ce-bac6-586e58cd36f5"</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Endpoint này cho phép tạo mới 1 scan</p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>POST https://api.cystack.io/v1/scans</code></p>
<h3 id='cac-tham-s-trong-json-body'>Các tham số trong JSON Body</h3>
<table><thead>
<tr>
<th>Tham số</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>target</td>
<td>ID của target cần Scan (String)</td>
</tr>
<tr>
<td>profile</td>
<td>Profile Scan (Integer)</td>
</tr>
<tr>
<td>notification</td>
<td>Danh sách người nhận thông báo (Integer List)</td>
</tr>
<tr>
<td>description</td>
<td>Thông tin mô tả về scan (String)</td>
</tr>
<tr>
<td>advances</td>
<td>Các thông tin nâng cao khác, tùy chọn (Object)</td>
</tr>
<tr>
<td>headers</td>
<td>Danh sách các header muốn thêm vào trong request (Dictionary)</td>
</tr>
<tr>
<td>authentication</td>
<td>Thông tin xác thực (Object)</td>
</tr>
<tr>
<td>authentication_method</td>
<td>Kiểu xác thực, các giá trị hợp lệ bao gồm <code>form</code>, <code>cookie</code>, <code>basic</code></td>
</tr>
<tr>
<td>username</td>
<td>Tên đăng nhập (String)</td>
</tr>
<tr>
<td>password</td>
<td>Password (String)</td>
</tr>
<tr>
<td>log_out_url</td>
<td>URL logout, dùng để tránh crawl địa chỉ này (String)</td>
</tr>
<tr>
<td>cookie</td>
<td>Giá trị cookie (String)</td>
</tr>
<tr>
<td>username_field</td>
<td>Tên biến ứng với username trong form authentication (String)</td>
</tr>
<tr>
<td>password_field</td>
<td>Tên biến ứng với password trong form authentication (String)</td>
</tr>
<tr>
<td>auth_url</td>
<td>URL login (String)</td>
</tr>
<tr>
<td>check_url</td>
<td>URL bất kỳ chứa <code>check_string</code>, đây là URL chỉ nhìn thấy được sau khi xác thực thành công (String)</td>
</tr>
<tr>
<td>check_string</td>
<td>Từ khóa, chuỗi muốn kiểm tra có tồn tại hay không (String)</td>
</tr>
</tbody></table>
<h2 id='li-t-ke-scan'>Liệt kê scan</h2><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">ROOT_URL</span> <span class="o">=</span> <span class="s">'https://api.cystack.io/v1'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'cystackapiexample'</span>
<span class="n">AUTHENTICATION_HEADER</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Bearer </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">API_KEY</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">list_scan</span><span class="p">():</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="s">"</span><span class="si">%</span><span class="s">s/scans"</span> <span class="o">%</span> <span class="n">ROOT_URL</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">AUTHENTICATION_HEADER</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.cystack.io/v1/scans"</span>
  -H <span class="s2">"Authorization: Bearer cystackapiexample"</span>
</code></pre>
<blockquote>
<p>Nếu thành công, kết quả nhận được sẽ là JSON như sau:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">  
   </span><span class="s2">"count"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
   </span><span class="s2">"next"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"previous"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
   </span><span class="s2">"results"</span><span class="p">:[</span><span class="w">  
      </span><span class="p">{</span><span class="w">  
         </span><span class="s2">"status"</span><span class="p">:</span><span class="s2">"Stopped"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"profile"</span><span class="p">:</span><span class="s2">"Full Audit"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"vulnerabilities"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
         </span><span class="s2">"start_time"</span><span class="p">:</span><span class="s2">"13:58:01 20/11/2017"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"href"</span><span class="p">:</span><span class="s2">"/v1/scans/07c13583-a14d-43b7-814d-a8f6db64253d"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"target"</span><span class="p">:{</span><span class="w">  
            </span><span class="s2">"ip"</span><span class="p">:</span><span class="s2">"42.112.22.134"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"os"</span><span class="p">:</span><span class="s2">"Unknown"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="s2">"03c0e5ad-767e-4c86-8adb-85509965fd54"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"address"</span><span class="p">:</span><span class="s2">"https://cystack.net"</span><span class="w">
         </span><span class="p">}</span><span class="w">
      </span><span class="p">}</span><span class="w">
   </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Endpoint này liệt kê tất cả các scan hiện có của user (ứng với API key)</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>GET https://api.cystack.io/v1/scans</code></p>
<h3 id='cac-tham-s-theo-url-2'>Các tham số theo URL</h3>
<table><thead>
<tr>
<th>Tham số</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>page</td>
<td>Mặc định, kết quả trả về sẽ được phân trang với 10 kết quả/trang. Tham số page nhận vào một số tự nhiên đại diện cho trang cần lấy</td>
</tr>
<tr>
<td>q</td>
<td>Từ khóa dùng để lọc target</td>
</tr>
<tr>
<td>ordering</td>
<td>Giá trị được ưu tiên sắp xếp. Giá trị tham số hợp lệ <code>?ordering=target</code>, <code>?ordering=start_time</code>, <code>?ordering=vulnerabilities</code>, <code>?ordering=target,start_time,vulnerabilities</code>. Nếu muốn sắp xếp theo chiều ngược lại, thêm dấu <code>-</code> vào trước giá trị cần sắp xếp chẳng hạn <code>?ordering=-target</code></td>
</tr>
<tr>
<td>status</td>
<td>Lọc theo trạng thái của scan, các giá trị hợp lệ bao gồm <code>Stopped</code>, <code>Running</code>, <code>Stopping</code>, <code>Queued</code></td>
</tr>
</tbody></table>
<h3 id='y-nghia-k-t-qu-tr-v-2'>Ý nghĩa kết quả trả về</h3>
<table><thead>
<tr>
<th>Key</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>count</td>
<td>Số lượng kết quả lấy được</td>
</tr>
<tr>
<td>next</td>
<td>URL trang kết quả tiếp theo, nếu trang tiếp theo không có dữ liệu thì trả về <code>null</code></td>
</tr>
<tr>
<td>previous</td>
<td>URL trang kết quả phía trước, nếu trang trước không có dữ liệu thì trả về <code>null</code></td>
</tr>
<tr>
<td>results</td>
<td>Một mảng các đối tượng scan, trong đó các thành phần được mô tả dưới đây</td>
</tr>
<tr>
<td>profile</td>
<td>Tên profile scan được sử dụng trong scan này</td>
</tr>
<tr>
<td>vulnerabilities</td>
<td>Số lượng lỗ hổng tìm thấy</td>
</tr>
<tr>
<td>start_time</td>
<td>Thời gian bắt đầu scan</td>
</tr>
<tr>
<td>href</td>
<td>Đường dẫn đến endpoint xem thông tin chi tiết scan. Địa chỉ tuyệt đối = <code>https://api.cystack.io</code> + <code>đường dẫn</code></td>
</tr>
<tr>
<td>target</td>
<td>Một dictionary chứa các thông tin của target</td>
</tr>
<tr>
<td>ip</td>
<td>IP của target</td>
</tr>
<tr>
<td>os</td>
<td>Hệ điều hành mà target đang sử dụng, trong trường hợp không xác định được thì trả về <code>Unknown</code></td>
</tr>
<tr>
<td>id</td>
<td>ID của target</td>
</tr>
<tr>
<td>address</td>
<td>Địa chỉ của target</td>
</tr>
</tbody></table>
<h2 id='d-ng-m-t-scan'>Dừng một scan</h2><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">ROOT_URL</span> <span class="o">=</span> <span class="s">'https://api.cystack.io/v1'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'cystackapiexample'</span>
<span class="n">AUTHENTICATION_HEADER</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Bearer </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">API_KEY</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">stop_scan</span><span class="p">(</span><span class="n">scan_id</span><span class="p">):</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="s">"</span><span class="si">%</span><span class="s">s/scans/</span><span class="si">%</span><span class="s">s/stop"</span> <span class="o">%</span> <span class="p">(</span><span class="n">ROOT_URL</span><span class="p">,</span> <span class="n">scan_id</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">AUTHENTICATION_HEADER</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">print</span> <span class="n">stop_scan</span><span class="p">(</span><span class="s">"9ba42a5f-f31d-4f18-9812-c7f18eca09e8"</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.cystack.io/v1/scans/9ba42a5f-f31d-4f18-9812-c7f18eca09e8/stop"</span>
  -H <span class="s2">"Authorization: Bearer cystackapiexample"</span>
</code></pre>
<blockquote>
<p>Nếu thành công, kết quả nhận được sẽ là JSON như sau (trong đó trường <code>status = Stopped</code>):</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Stopped"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"profile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Full Audit"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"None"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"noti_href"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"/v1/notifications/29"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1511957637</span><span class="p">,</span><span class="w">
  </span><span class="s2">"stop_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1511958637</span><span class="p">,</span><span class="w">
  </span><span class="s2">"vuln_href"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"/v1/vulnerabilities/4b2dad22-3fc7-4719-a67c-2bcd0317b632"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"/v1/vulnerabilities/5c067b1e-ffc6-41fc-9678-352cd391cc3d"</span><span class="p">,</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"target"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"42.112.22.134"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"os"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Unknown"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"395a2f59-ad32-4e1c-b9b0-4063a55cf4e2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://cystack.net"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Endpoint này cho phép dừng 1 scan đang chạy</p>
<h3 id='http-request-4'>HTTP Request</h3>
<p><code>GET https://api.cystack.io/v1/scans/&lt;scan_id&gt;/stop</code></p>
<h3 id='y-nghia-k-t-qu-tr-v-3'>Ý nghĩa kết quả trả về</h3>
<table><thead>
<tr>
<th>Key</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>Trạng thái của Scan</td>
</tr>
<tr>
<td>profile</td>
<td>Tên profile scan được sử dụng trong scan này</td>
</tr>
<tr>
<td>description</td>
<td>Mô tả về scan</td>
</tr>
<tr>
<td>start_time</td>
<td>Thời gian bắt đầu scan</td>
</tr>
<tr>
<td>start_time</td>
<td>Thời gian kết thúc scan</td>
</tr>
<tr>
<td>noti_href</td>
<td>Một danh sách tham chiếu đến những người được notify</td>
</tr>
<tr>
<td>vuln_href</td>
<td>Một danh sách tham chiếu đến các lỗ hổng tìm thấy</td>
</tr>
<tr>
<td>target</td>
<td>Một dictionary chứa các thông tin của target</td>
</tr>
<tr>
<td>ip</td>
<td>IP của target</td>
</tr>
<tr>
<td>os</td>
<td>Hệ điều hành mà target đang sử dụng, trong trường hợp không xác định được thì trả về <code>Unknown</code></td>
</tr>
<tr>
<td>id</td>
<td>ID của target</td>
</tr>
<tr>
<td>address</td>
<td>Địa chỉ của target</td>
</tr>
</tbody></table>
<h2 id='xem-chi-ti-t-m-t-scan'>Xem chi tiết một scan</h2><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">ROOT_URL</span> <span class="o">=</span> <span class="s">'https://api.cystack.io/v1'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'cystackapiexample'</span>
<span class="n">AUTHENTICATION_HEADER</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Bearer </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">API_KEY</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">detail_scan</span><span class="p">(</span><span class="n">scan_id</span><span class="p">):</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="s">"</span><span class="si">%</span><span class="s">s/scans/</span><span class="si">%</span><span class="s">s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">ROOT_URL</span><span class="p">,</span> <span class="n">scan_id</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">AUTHENTICATION_HEADER</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

<span class="k">print</span> <span class="n">detail_scan</span><span class="p">(</span><span class="s">"9ba42a5f-f31d-4f18-9812-c7f18eca09e8"</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.cystack.io/v1/scans/9ba42a5f-f31d-4f18-9812-c7f18eca09e8"</span>
  -H <span class="s2">"Authorization: Bearer cystackapiexample"</span>
</code></pre>
<blockquote>
<p>Nếu thành công, kết quả nhận được sẽ là JSON như sau:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Stopped"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"profile"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Full Audit"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"None"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"noti_href"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"/v1/notifications/29"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1511957637</span><span class="p">,</span><span class="w">
  </span><span class="s2">"stop_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1511958637</span><span class="p">,</span><span class="w">
  </span><span class="s2">"vuln_href"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"/v1/vulnerabilities/4b2dad22-3fc7-4719-a67c-2bcd0317b632"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"/v1/vulnerabilities/5c067b1e-ffc6-41fc-9678-352cd391cc3d"</span><span class="p">,</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"target"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"42.112.22.134"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"os"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Unknown"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"395a2f59-ad32-4e1c-b9b0-4063a55cf4e2"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://cystack.net"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Endpoint này trả về thông tin chi tiết của 1 scan</p>
<h3 id='http-request-5'>HTTP Request</h3>
<p><code>GET https://api.cystack.io/v1/scans/&lt;scan_id&gt;</code></p>
<h3 id='y-nghia-k-t-qu-tr-v-4'>Ý nghĩa kết quả trả về</h3>
<table><thead>
<tr>
<th>Key</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>Trạng thái của Scan</td>
</tr>
<tr>
<td>profile</td>
<td>Tên profile scan được sử dụng trong scan này</td>
</tr>
<tr>
<td>description</td>
<td>Mô tả về scan</td>
</tr>
<tr>
<td>start_time</td>
<td>Thời gian bắt đầu scan</td>
</tr>
<tr>
<td>start_time</td>
<td>Thời gian kết thúc scan</td>
</tr>
<tr>
<td>noti_href</td>
<td>Một danh sách tham chiếu đến những người được notify</td>
</tr>
<tr>
<td>vuln_href</td>
<td>Một danh sách tham chiếu đến các lỗ hổng tìm thấy</td>
</tr>
<tr>
<td>target</td>
<td>Một dictionary chứa các thông tin của target</td>
</tr>
<tr>
<td>ip</td>
<td>IP của target</td>
</tr>
<tr>
<td>os</td>
<td>Hệ điều hành mà target đang sử dụng, trong trường hợp không xác định được thì trả về <code>Unknown</code></td>
</tr>
<tr>
<td>id</td>
<td>ID của target</td>
</tr>
<tr>
<td>address</td>
<td>Địa chỉ của target</td>
</tr>
</tbody></table>
<h2 id='xoa-m-t-scan'>Xóa một scan</h2><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">ROOT_URL</span> <span class="o">=</span> <span class="s">'https://api.cystack.io/v1'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'cystackapiexample'</span>
<span class="n">AUTHENTICATION_HEADER</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Bearer </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">API_KEY</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">delete_scan</span><span class="p">(</span><span class="n">scan_id</span><span class="p">):</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="s">"</span><span class="si">%</span><span class="s">s/scans/</span><span class="si">%</span><span class="s">s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">ROOT_URL</span><span class="p">,</span> <span class="n">scan_id</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">AUTHENTICATION_HEADER</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">204</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">print</span> <span class="n">delete_scan</span><span class="p">(</span><span class="s">"9ba42a5f-f31d-4f18-9812-c7f18eca09e8"</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl -i -s -k  -X <span class="s1">$'DELETE'</span> <span class="se">\</span>
    -H <span class="s1">$'Authorization: Bearer cystackapiexample'</span> -H <span class="s1">$'content-type: application/json'</span> <span class="se">\</span>
    <span class="s1">$'https://api.cystack.io/v1/scans/098d3ca7-d461-4f15-ad17-909158a41966'</span>
</code></pre>
<blockquote>
<p>Nếu thành công, HTTP Response sẽ có Status code <code>204</code> No Content và không có Response Body</p>
</blockquote>

<p>Endpoint này cho phép xóa 1 scan</p>
<h3 id='http-request-6'>HTTP Request</h3>
<p><code>DELETE https://api.cystack.io/v1/scans/&lt;scan_id&gt;</code></p>
<h1 id='vulnerability'>Vulnerability</h1><h2 id='khai-ni-m-2'>Khái niệm</h2>
<p>Một Vulnerability tương ứng với một lỗ hổng tìm được sau khi scan</p>
<h2 id='li-t-ke-l-h-ng'>Liệt kê lỗ hổng</h2><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">ROOT_URL</span> <span class="o">=</span> <span class="s">'https://api.cystack.io/v1'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'cystackapiexample'</span>
<span class="n">AUTHENTICATION_HEADER</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Bearer </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">API_KEY</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">list_vulnerability</span><span class="p">():</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="s">"</span><span class="si">%</span><span class="s">s/vulnerabilities"</span> <span class="o">%</span> <span class="n">ROOT_URL</span>
    <span class="k">print</span> <span class="n">endpoint</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">AUTHENTICATION_HEADER</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">print</span> <span class="n">list_vulnerability</span><span class="p">()</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.cystack.io/v1/vulnerabilities"</span>
  -H <span class="s2">"Authorization: Bearer cystackapiexample"</span>
</code></pre>
<blockquote>
<p>Nếu thành công, kết quả nhận được sẽ là JSON như sau:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"count"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="s2">"next"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://cystack.io/v1/vulnerabilities?page=2"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"previous"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
  </span><span class="s2">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"false_positive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"severity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Medium"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Click-Jacking vulnerability"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"/v1/vulnerabilities/060d674c-fb48-4182-83db-85e0323b8fd1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"060d674c-fb48-4182-83db-85e0323b8fd1"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"target"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://cystack.net"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Endpoint này liệt kê tất cả các lỗ hổng hiện có của user (ứng với API key)</p>
<h3 id='http-request-7'>HTTP Request</h3>
<p><code>GET https://api.cystack.io/v1/vulnerabilities</code></p>
<h3 id='cac-tham-s-theo-url-3'>Các tham số theo URL</h3>
<table><thead>
<tr>
<th>Tham số</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>page</td>
<td>Mặc định, kết quả trả về sẽ được phân trang với 10 kết quả/trang. Tham số page nhận vào một số tự nhiên đại diện cho trang cần lấy</td>
</tr>
<tr>
<td>q</td>
<td>Từ khóa dùng để lọc vulnerability và target</td>
</tr>
<tr>
<td>ordering</td>
<td>Giá trị được ưu tiên sắp xếp. Giá trị tham số hợp lệ <code>?ordering=severity</code>, <code>?ordering=target</code>, <code>ordering=false_positive</code>, <code>ordering=name</code>, <code>?ordering=severity,false_positive,name,target</code>. Nếu muốn sắp xếp theo chiều ngược lại, thêm dấu <code>-</code> vào trước giá trị cần sắp xếp chẳng hạn <code>?ordering=-target</code></td>
</tr>
<tr>
<td>sev</td>
<td>Lọc theo mức độ nguy hiểm của lỗi, các giá trị hợp lệ bao gồm <code>High</code>, <code>Medium</code>, <code>Low</code>, <code>Information</code></td>
</tr>
</tbody></table>
<h3 id='y-nghia-k-t-qu-tr-v-5'>Ý nghĩa kết quả trả về</h3>
<table><thead>
<tr>
<th>Key</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>count</td>
<td>Số lượng kết quả lấy được</td>
</tr>
<tr>
<td>next</td>
<td>URL trang kết quả tiếp theo, nếu trang tiếp theo không có dữ liệu thì trả về <code>null</code></td>
</tr>
<tr>
<td>previous</td>
<td>URL trang kết quả phía trước, nếu trang trước không có dữ liệu thì trả về <code>null</code></td>
</tr>
<tr>
<td>results</td>
<td>Một mảng các đối tượng vulnerabilities, trong đó các thành phần được mô tả dưới đây</td>
</tr>
<tr>
<td>false_positive</td>
<td>Lỗi có phải false positive hay không</td>
</tr>
<tr>
<td>severity</td>
<td>Mức độ nguy hiểm của lỗi</td>
</tr>
<tr>
<td>name</td>
<td>Tên của lỗi</td>
</tr>
<tr>
<td>href</td>
<td>Đường dẫn đến endpoint xem thông tin chi tiết vulnerability</td>
</tr>
<tr>
<td>id</td>
<td>ID của vulnerability</td>
</tr>
<tr>
<td>target</td>
<td>Địa chỉ của target</td>
</tr>
</tbody></table>
<h2 id='xem-chi-ti-t-l-h-ng'>Xem chi tiết lỗ hổng</h2><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">ROOT_URL</span> <span class="o">=</span> <span class="s">'https://api.cystack.io/v1'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'cystackapiexample'</span>
<span class="n">AUTHENTICATION_HEADER</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Bearer </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">API_KEY</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">detail_vulnerability</span><span class="p">(</span><span class="n">vuln_id</span><span class="p">):</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="s">"</span><span class="si">%</span><span class="s">s/vulnerabilities/</span><span class="si">%</span><span class="s">s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">ROOT_URL</span><span class="p">,</span> <span class="n">vuln_id</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">AUTHENTICATION_HEADER</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">print</span> <span class="n">detail_vulnerability</span><span class="p">(</span><span class="s">'060d674c-fb48-4182-83db-85e0323b8fd1'</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.cystack.io/v1/vulnerabilities/060d674c-fb48-4182-83db-85e0323b8fd1"</span>
  -H <span class="s2">"Authorization: Bearer cystackapiexample"</span>
</code></pre>
<blockquote>
<p>Nếu thành công, kết quả nhận được sẽ là JSON như sau:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"traffic_hrefs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"/v1/vulnerabilities/060d674c-fb48-4182-83db-85e0323b8fd1/traffics/5a1b8babcca1e02c146c4afa"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The whole target has no protection (X-Frame-Options header) against Click-Jacking attacksClickjacking (User Interface redress attack, UI redress attack, UI redressing) is a malicious technique of tricking a Web user into clicking on something different from what the user perceives they are clicking on, thus potentially revealing confidential information or taking control of their computer while clicking on seemingly innocuous web pages."</span><span class="p">,</span><span class="w">
  </span><span class="s2">"long_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The server didn't return an `X-Frame-Options` header which means that this website could be at risk of a clickjacking attack. The `X-Frame-Options` HTTP response header can be used to indicate whether or not a browser should be allowed to render a page inside a frame or iframe. Sites can use this to avoid clickjacking attacks, by ensuring that their content is not embedded into other sites."</span><span class="p">,</span><span class="w">
  </span><span class="s2">"scan"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"target"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"395a2f59-ad32-4e1c-b9b0-4063a55cf4e2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://cystack.net"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"06b804ed-2775-4e35-90d2-bd5a047762c3"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"severity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Medium"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"solution"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Configure your web server to include an X-Frame-Options header."</span><span class="p">,</span><span class="w">
  </span><span class="s2">"plugin_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"click_jacking"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"false_positive"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
  </span><span class="s2">"references"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://tools.ietf.org/html/rfc7034"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RFC-7034"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://developer.mozilla.org/en-US/docs/Web/HTTP/X-Frame-Options"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mozilla developer network"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.owasp.org/index.php/Clickjacking"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OWASP Clickjacking document"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://vulndb.github.io/vuln/53"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Vulndb-53"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"urls"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"None"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"var"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"060d674c-fb48-4182-83db-85e0323b8fd1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Click-Jacking vulnerability"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Endpoint này trả về thông tin chi tiết của 1 vulnerability</p>
<h3 id='http-request-8'>HTTP Request</h3>
<p><code>GET https://api.cystack.io/v1/vulnerabilities/&lt;vuln_id&gt;</code></p>
<h3 id='y-nghia-k-t-qu-tr-v-6'>Ý nghĩa kết quả trả về</h3>
<table><thead>
<tr>
<th>Key</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>traffic_hrefs</td>
<td>Danh sách href các traffic của vulnerability</td>
</tr>
<tr>
<td>description</td>
<td>Mô tả về lỗi</td>
</tr>
<tr>
<td>long_description</td>
<td>Mô tả thêm về loại lỗi</td>
</tr>
<tr>
<td>severity</td>
<td>Mức độ nguy hiểm của vulnerability</td>
</tr>
<tr>
<td>solution</td>
<td>Cách xử lý vulnerability</td>
</tr>
<tr>
<td>plugin_name</td>
<td>Tên plugin phát hiện ra lỗi</td>
</tr>
<tr>
<td>false_positive</td>
<td>Lỗi có phải false positive hay không</td>
</tr>
<tr>
<td>scan</td>
<td>Thông tin về đối tượng scan, trong đó bao gồm scan_id và target</td>
</tr>
<tr>
<td>references</td>
<td>Danh sách các tài liệu tham chiếu đến lỗi</td>
</tr>
<tr>
<td>urls</td>
<td>Danh sách các URL bị lỗi</td>
</tr>
<tr>
<td>var</td>
<td>Tham số chứa lỗi</td>
</tr>
<tr>
<td>attributes</td>
<td>Các thuộc tính của lỗi (nâng cao)</td>
</tr>
<tr>
<td>id</td>
<td>ID của lỗi</td>
</tr>
<tr>
<td>name</td>
<td>Tên của lỗi</td>
</tr>
</tbody></table>
<h2 id='c-p-nh-t-l-h-ng'>Cập nhật lỗ hổng</h2><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">ROOT_URL</span> <span class="o">=</span> <span class="s">'https://api.cystack.io/v1'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'cystackapiexample'</span>
<span class="n">AUTHENTICATION_HEADER</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Bearer </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">API_KEY</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">update_vulnerability</span><span class="p">(</span><span class="n">vuln_id</span><span class="p">):</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="s">"</span><span class="si">%</span><span class="s">s/vulnerabilities/</span><span class="si">%</span><span class="s">s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">ROOT_URL</span><span class="p">,</span> <span class="n">vuln_id</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">"false_positive"</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">AUTHENTICATION_HEADER</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">print</span> <span class="n">update_vulnerability</span><span class="p">(</span><span class="s">'060d674c-fb48-4182-83db-85e0323b8fd1'</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl -i -s -k  -X <span class="s1">'PUT'</span> <span class="s2">"https://api.cystack.io/v1/vulnerabilities/060d674c-fb48-4182-83db-85e0323b8fd1"</span> <span class="se">\</span>
    -H <span class="s2">"Authorization: Bearer cystackapiexample"</span> <span class="se">\</span>
    --data-binary <span class="s1">$'{</span><span class="se">\"</span><span class="s1">false_positive</span><span class="se">\"</span><span class="s1">:true}'</span> 
</code></pre>
<blockquote>
<p>Nếu thành công, kết quả nhận được sẽ là JSON như sau:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"traffic_hrefs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"/v1/vulnerabilities/060d674c-fb48-4182-83db-85e0323b8fd1/traffics/5a1b8babcca1e02c146c4afa"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The whole target has no protection (X-Frame-Options header) against Click-Jacking attacksClickjacking (User Interface redress attack, UI redress attack, UI redressing) is a malicious technique of tricking a Web user into clicking on something different from what the user perceives they are clicking on, thus potentially revealing confidential information or taking control of their computer while clicking on seemingly innocuous web pages."</span><span class="p">,</span><span class="w">
  </span><span class="s2">"long_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The server didn't return an `X-Frame-Options` header which means that this website could be at risk of a clickjacking attack. The `X-Frame-Options` HTTP response header can be used to indicate whether or not a browser should be allowed to render a page inside a frame or iframe. Sites can use this to avoid clickjacking attacks, by ensuring that their content is not embedded into other sites."</span><span class="p">,</span><span class="w">
  </span><span class="s2">"scan"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"target"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"395a2f59-ad32-4e1c-b9b0-4063a55cf4e2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://cystack.net"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"06b804ed-2775-4e35-90d2-bd5a047762c3"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"severity"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Medium"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"solution"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Configure your web server to include an X-Frame-Options header."</span><span class="p">,</span><span class="w">
  </span><span class="s2">"plugin_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"click_jacking"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"false_positive"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"references"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://tools.ietf.org/html/rfc7034"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"RFC-7034"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://developer.mozilla.org/en-US/docs/Web/HTTP/X-Frame-Options"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mozilla developer network"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://www.owasp.org/index.php/Clickjacking"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"OWASP Clickjacking document"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://vulndb.github.io/vuln/53"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Vulndb-53"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"urls"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"None"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"var"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="s2">"attributes"</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"060d674c-fb48-4182-83db-85e0323b8fd1"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Click-Jacking vulnerability"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Endpoint này giúp cập nhật trạng thái <code>false_positive</code> của một lỗi</p>
<h3 id='http-request-9'>HTTP Request</h3>
<p><code>PUT https://api.cystack.io/v1/vulnerabilities/&lt;vuln_id&gt;</code></p>
<h3 id='cac-tham-s-trong-json-body-2'>Các tham số trong json body</h3>
<table><thead>
<tr>
<th>Tham số</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>false_positive</td>
<td>Cho biết lỗi này có bị false positive hay không. Các giá trị hợp lệ là <code>true</code> và <code>false</code></td>
</tr>
</tbody></table>
<h3 id='y-nghia-k-t-qu-tr-v-7'>Ý nghĩa kết quả trả về</h3>
<table><thead>
<tr>
<th>Key</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>traffic_hrefs</td>
<td>Danh sách href các traffic của vulnerability</td>
</tr>
<tr>
<td>description</td>
<td>Mô tả về lỗi</td>
</tr>
<tr>
<td>long_description</td>
<td>Mô tả thêm về loại lỗi</td>
</tr>
<tr>
<td>severity</td>
<td>Mức độ nguy hiểm của vulnerability</td>
</tr>
<tr>
<td>solution</td>
<td>Cách xử lý vulnerability</td>
</tr>
<tr>
<td>plugin_name</td>
<td>Tên plugin phát hiện ra lỗi</td>
</tr>
<tr>
<td>false_positive</td>
<td>Lỗi có phải false positive hay không</td>
</tr>
<tr>
<td>scan</td>
<td>Thông tin về đối tượng scan, trong đó bao gồm scan_id và target</td>
</tr>
<tr>
<td>references</td>
<td>Danh sách các tài liệu tham chiếu đến lỗi</td>
</tr>
<tr>
<td>urls</td>
<td>Danh sách các URL bị lỗi</td>
</tr>
<tr>
<td>var</td>
<td>Tham số chứa lỗi</td>
</tr>
<tr>
<td>attributes</td>
<td>Các thuộc tính của lỗi (nâng cao)</td>
</tr>
<tr>
<td>id</td>
<td>ID của lỗi</td>
</tr>
<tr>
<td>name</td>
<td>Tên của lỗi</td>
</tr>
</tbody></table>
<h1 id='monitoring'>Monitoring</h1><h2 id='khai-ni-m-3'>Khái niệm</h2>
<p>Monitoring là chức năng giám sát tình trạng hoạt động của website, gồm tình trạng up/down và tình trạng an ninh</p>
<h2 id='l-y-thong-tin-v-tr-ng-thai-up-down'>Lấy thông tin về trạng thái up/down</h2><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">ROOT_URL</span> <span class="o">=</span> <span class="s">'https://api.cystack.io/v1'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'cystackapiexample'</span>
<span class="n">AUTHENTICATION_HEADER</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Bearer </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">API_KEY</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">up_down</span><span class="p">(</span><span class="n">target_id</span><span class="p">):</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="s">"</span><span class="si">%</span><span class="s">s/targets/</span><span class="si">%</span><span class="s">s/monitor_result"</span> <span class="o">%</span> <span class="p">(</span><span class="n">ROOT_URL</span><span class="p">,</span> <span class="n">target_id</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">AUTHENTICATION_HEADER</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">print</span> <span class="n">up_down</span><span class="p">(</span><span class="s">"de3b1674-a507-4293-a360-50f8ffe3a921"</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.cystack.io/v1/targets/de3b1674-a507-4293-a360-50f8ffe3a921/monitor_result"</span>
  -H <span class="s2">"Authorization: Bearer cystackapiexample"</span>
</code></pre>
<blockquote>
<p>Nếu thành công, kết quả nhận được sẽ là JSON như sau:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://cystack.net"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"status_code"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
    </span><span class="s2">"start_time"</span><span class="p">:</span><span class="w"> </span><span class="mi">1514969894</span><span class="p">,</span><span class="w">
    </span><span class="s2">"target_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"de3b1674-a507-4293-a360-50f8ffe3a921"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"is_up"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"timeout"</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5a4c9b2608b54160f50f4e64"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"response_time"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.5933599472045898</span><span class="p">,</span><span class="w">
    </span><span class="s2">"notify"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p>Endpoint này cho phép truy vấn tình trạng Up/Down của 1 target. Số lượng phần tử trong mảng trả về tương ứng với số thời điểm kiểm tra, trong khoảng thời gian từ <code>now - interval_time * 30</code> đến <code>now</code> (<code>now</code> là thời điểm hiện tại)</p>
<h3 id='http-request-10'>HTTP Request</h3>
<p><code>GET https://api.cystack.io/v1/targets/&lt;target_id&gt;/monitor_result</code></p>
<h3 id='cac-tham-s-theo-url-4'>Các tham số theo URL</h3>
<table><thead>
<tr>
<th>Tham số</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>target_id</td>
<td>ID của target</td>
</tr>
</tbody></table>
<h3 id='y-nghia-k-t-qu-tr-v-8'>Ý nghĩa kết quả trả về</h3>
<table><thead>
<tr>
<th>Key</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>url</td>
<td>Địa chỉ target (String)</td>
</tr>
<tr>
<td>status_code</td>
<td>HTTP Code trả về khi request đến địa chỉ trên (Integer)</td>
</tr>
<tr>
<td>start_time</td>
<td>Thời điểm request kiểm tra (Unix Time Stamp)</td>
</tr>
<tr>
<td>target_id</td>
<td>ID của target (String)</td>
</tr>
<tr>
<td>is_up</td>
<td>Trạng thái up/down (Boolean)</td>
</tr>
<tr>
<td>timeout</td>
<td>Thời gian timeout khi request (Second)</td>
</tr>
<tr>
<td>id</td>
<td>ID của lượt request (String)</td>
</tr>
<tr>
<td>response_time</td>
<td>Thời gian phản hồi của target (Float, second)</td>
</tr>
<tr>
<td>notify</td>
<td>Gửi cảnh báo đến người dùng hay không (Boolean)</td>
</tr>
</tbody></table>
<h2 id='l-y-thong-tin-c-u-hinh-ki-m-tra-up-down'>Lấy thông tin cấu hình kiểm tra up/down</h2><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">ROOT_URL</span> <span class="o">=</span> <span class="s">'https://api.cystack.io/v1'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'cystackapiexample'</span>
<span class="n">AUTHENTICATION_HEADER</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Bearer </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">API_KEY</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">get_settings</span><span class="p">(</span><span class="n">target_id</span><span class="p">):</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="s">"</span><span class="si">%</span><span class="s">s/targets/</span><span class="si">%</span><span class="s">s/monitoring"</span> <span class="o">%</span> <span class="p">(</span><span class="n">ROOT_URL</span><span class="p">,</span> <span class="n">target_id</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">AUTHENTICATION_HEADER</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">print</span> <span class="n">get_settings</span><span class="p">(</span><span class="s">"de3b1674-a507-4293-a360-50f8ffe3a921"</span><span class="p">)</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl <span class="s2">"https://api.cystack.io/v1/targets/de3b1674-a507-4293-a360-50f8ffe3a921/monitoring"</span>
  -H <span class="s2">"Authorization: Bearer cystackapiexample"</span>
</code></pre>
<blockquote>
<p>Nếu thành công, kết quả nhận được sẽ là JSON như sau:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"interval"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="s2">"is_activated"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"notifications"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="mi">20</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Endpoint này cho phép truy vấn các cấu hình được thiết lập để kiểm tra tình trạng up/down của target</p>
<h3 id='http-request-11'>HTTP Request</h3>
<p><code>GET https://api.cystack.io/v1/targets/&lt;target_id&gt;/monitoring</code></p>
<h3 id='cac-tham-s-theo-url-5'>Các tham số theo URL</h3>
<table><thead>
<tr>
<th>Tham số</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>target_id</td>
<td>ID của target</td>
</tr>
</tbody></table>
<h3 id='y-nghia-k-t-qu-tr-v-9'>Ý nghĩa kết quả trả về</h3>
<table><thead>
<tr>
<th>Key</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>interval</td>
<td>Khoảng thời gian giữa 2 lần kiểm tra gần nhất (Integer, Minute)</td>
</tr>
<tr>
<td>is_activated</td>
<td>Kích hoạt hay không việc kiểm tra up/down cho target (Boolean)</td>
</tr>
<tr>
<td>notifications</td>
<td>Danh sách ID của những người nhận email thông báo (Array Integer)</td>
</tr>
</tbody></table>
<h2 id='c-p-nh-t-c-u-hinh-ki-m-tra-up-down'>Cập nhật cấu hình kiểm tra up/down</h2><pre class="highlight python tab-python"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">ROOT_URL</span> <span class="o">=</span> <span class="s">'https://api.cystack.io/v1'</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'cystackapiexample'</span>
<span class="n">AUTHENTICATION_HEADER</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Authorization'</span><span class="p">:</span> <span class="s">'Bearer </span><span class="si">%</span><span class="s">s'</span> <span class="o">%</span> <span class="n">API_KEY</span><span class="p">}</span>


<span class="k">def</span> <span class="nf">update_settings</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">endpoint</span> <span class="o">=</span> <span class="s">"</span><span class="si">%</span><span class="s">s/targets/</span><span class="si">%</span><span class="s">s/monitoring"</span> <span class="o">%</span> <span class="p">(</span><span class="n">ROOT_URL</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s">'target_id'</span><span class="p">])</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span><span class="s">"interval"</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s">"interval"</span><span class="p">],</span> <span class="s">"is_activated"</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s">"is_activated"</span><span class="p">],</span>
               <span class="s">"notifications"</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s">"notifications"</span><span class="p">]}</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">endpoint</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">AUTHENTICATION_HEADER</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">payload</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">print</span> <span class="n">update_settings</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">"target_id"</span><span class="p">:</span> <span class="s">"de3b1674-a507-4293-a360-50f8ffe3a921"</span><span class="p">,</span> <span class="s">"interval"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s">"is_activated"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">"notifications"</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">]})</span>
</code></pre><pre class="highlight shell tab-shell"><code>curl -i -s -k  -X <span class="s1">$'PUT'</span> <span class="se">\</span>
    -H <span class="s1">$'Authorization: Bearer cystackapiexample'</span> -H <span class="s1">$'content-type: application/json'</span> <span class="se">\</span>
    --data-binary <span class="s1">$'{</span><span class="se">\"</span><span class="s1">interval</span><span class="se">\"</span><span class="s1">:10,</span><span class="se">\"</span><span class="s1">is_activated</span><span class="se">\"</span><span class="s1">:false,</span><span class="se">\"</span><span class="s1">notifications</span><span class="se">\"</span><span class="s1">:[20]}'</span> <span class="se">\</span>
    <span class="s1">$'https://api.cystack.io/v1/targets/de3b1674-a507-4293-a360-50f8ffe3a921/monitoring'</span>
</code></pre>
<blockquote>
<p>Nếu thành công, kết quả nhận được sẽ là JSON như sau:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"interval"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="s2">"is_activated"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"notifications"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="mi">20</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Endpoint này cho phép thiết lập lại các cấu hình kiểm tra tình trạng up/down của target</p>
<h3 id='http-request-12'>HTTP Request</h3>
<p><code>PUT https://api.cystack.io/v1/targets/&lt;target_id&gt;/monitoring</code></p>
<h3 id='cac-tham-s-theo-url-6'>Các tham số theo URL</h3>
<table><thead>
<tr>
<th>Tham số</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>target_id</td>
<td>ID của target</td>
</tr>
</tbody></table>
<h3 id='y-nghia-k-t-qu-tr-v-10'>Ý nghĩa kết quả trả về</h3>
<table><thead>
<tr>
<th>Key</th>
<th>Mô tả</th>
</tr>
</thead><tbody>
<tr>
<td>interval</td>
<td>Khoảng thời gian giữa 2 lần kiểm tra gần nhất (Integer, Minute)</td>
</tr>
<tr>
<td>is_activated</td>
<td>Kích hoạt hay không việc kiểm tra up/down cho target (Boolean)</td>
</tr>
<tr>
<td>notifications</td>
<td>Danh sách ID của những người nhận email thông báo (Array Integer)</td>
</tr>
</tbody></table>
<h1 id='errors'>Errors</h1>
<aside class="notice">This error section is stored in a separate file in `includes/_errors.md`. Slate allows you to optionally separate out your docs into many files...just save them to the `includes` folder and add them to the top of your `index.md`'s frontmatter. Files are included in the order listed.</aside>

<p>The Kittn API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- Your request sucks.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized -- Your API key is wrong.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden -- The kitten requested is hidden for administrators only.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- The specified kitten could not be found.</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed -- You tried to access a kitten with an invalid method.</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable -- You requested a format that isn&#39;t json.</td>
</tr>
<tr>
<td>410</td>
<td>Gone -- The kitten requested has been removed from our servers.</td>
</tr>
<tr>
<td>418</td>
<td>I&#39;m a teapot.</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests -- You&#39;re requesting too many kittens! Slow down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error -- We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable -- We&#39;re temporarily offline for maintenance. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="python">python</a>
          </div>
      </div>
    </div>
  </body>
</html>
